(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{375:function(a,s,t){"use strict";t.r(s);var e=t(7),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("配套视频参考："),s("a",{attrs:{href:"https://www.bilibili.com/video/BV1iq4y1u7vj?p=1&vd_source=cea816a08805c218ac4390ae9b61ae31",target:"_blank",rel:"noopener noreferrer"}},[a._v("MySQL数据库天花板--康师傅"),s("OutboundLink")],1)]),a._v(" "),s("h4",{attrs:{id:"_1-用户管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户管理"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.")]),a._v(" "),s("strong",[a._v("用户管理")])]),a._v(" "),s("h5",{attrs:{id:"_1-1-登录mysql服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-登录mysql服务器"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.1")]),a._v(" "),s("strong",[a._v("登录MySQL服务器")])]),a._v(" "),s("p",[a._v("启动MySQL服务后，可以通过mysql命令来登录MySQL服务器，命令如下：")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('mysql –h hostname|hostIP –P port –u username –p DatabaseName –e "SQL语句"\n')])])]),s("ul",[s("li",[s("code",[a._v("-h参数")]),a._v("后面接主机名或者主机IP，hostname为主机，hostIP为主机IP。")]),a._v(" "),s("li",[s("code",[a._v("-P参数")]),a._v("后面接MySQL服务的端口，通过该参数连接到指定的端口。MySQL服务的默认端口是3306，不使用该参数时自动连接到3306端口，port为连接的端口号。")]),a._v(" "),s("li",[s("code",[a._v("-u参数")]),a._v("后面接用户名，username为用户名。")]),a._v(" "),s("li",[s("code",[a._v("-p参数")]),a._v("会提示输入密码。")]),a._v(" "),s("li",[s("code",[a._v("DatabaseName参数")]),a._v("指明登录到哪一个数据库中。如果没有该参数，就会直接登录到MySQL数据库中，然后可以使用USE命令来选择数据库。")]),a._v(" "),s("li",[s("code",[a._v("-e参数")]),a._v("后面可以直接加SQL语句。登录MySQL服务器以后即可执行这个SQL语句，然后退出MySQL服务器。")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('mysql -uroot -p -hlocalhost -P3306 mysql -e "select host,user from user"\n')])])]),s("h5",{attrs:{id:"_1-2-创建用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-创建用户"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.2")]),a._v(" "),s("strong",[a._v("创建用户")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("CREATE USER 用户名 [IDENTIFIED BY '密码'][,用户名 [IDENTIFIED BY '密码']];\n")])])]),s("p",[a._v("举例：")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("CREATE USER zhang3 IDENTIFIED BY '123123'; # 默认host是 %\nCREATE USER 'kangshifu'@'localhost' IDENTIFIED BY '123456';\n")])])]),s("h5",{attrs:{id:"_1-3-修改用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-修改用户"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.3")]),a._v(" "),s("strong",[a._v("修改用户")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("UPDATE mysql.user SET USER='li4' WHERE USER='wang5'; \nFLUSH PRIVILEGES;\n")])])]),s("h5",{attrs:{id:"_1-4-删除用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-删除用户"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.4")]),a._v(" "),s("strong",[a._v("删除用户")])]),a._v(" "),s("p",[s("strong",[a._v("方式1：使用DROP方式删除（推荐）")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("DROP USER user[,user]…;\n")])])]),s("p",[a._v("举例：")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("DROP USER li4 ; # 默认删除host为%的用户\nDROP USER 'kangshifu'@'localhost';\n")])])]),s("p",[s("strong",[a._v("方式2：使用DELETE方式删除（不推荐，有残留信息）")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("DELETE FROM mysql.user WHERE Host=’hostname’ AND User=’username’;\nFLUSH PRIVILEGES;\n")])])]),s("h5",{attrs:{id:"_1-5-设置当前用户密码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-设置当前用户密码"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.5")]),a._v(" "),s("strong",[a._v("设置当前用户密码")])]),a._v(" "),s("p",[s("strong",[a._v("1.")]),a._v(" "),s("strong",[a._v("使用ALTER USER命令来修改当前用户密码")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ALTER USER USER() IDENTIFIED BY 'new_password';\n")])])]),s("p",[s("strong",[a._v("2.")]),a._v(" "),s("strong",[a._v("使用SET语句来修改当前用户密码")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET PASSWORD='new_password';\n")])])]),s("h5",{attrs:{id:"_1-6-修改其它用户密码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-修改其它用户密码"}},[a._v("#")]),a._v(" "),s("strong",[a._v("1.6")]),a._v(" "),s("strong",[a._v("修改其它用户密码")])]),a._v(" "),s("p",[s("strong",[a._v("1.")]),a._v(" "),s("strong",[a._v("使用ALTER语句来修改普通用户的密码")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ALTER USER user [IDENTIFIED BY '新密码'] \n[,user[IDENTIFIED BY '新密码']]…;\n")])])]),s("p",[s("strong",[a._v("2.")]),a._v(" "),s("strong",[a._v("使用SET命令来修改普通用户的密码")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET PASSWORD FOR 'username'@'hostname'='new_password';\n")])])]),s("h4",{attrs:{id:"_2-权限管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-权限管理"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.")]),a._v(" "),s("strong",[a._v("权限管理")])]),a._v(" "),s("h5",{attrs:{id:"_2-1-权限列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-权限列表"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.1")]),a._v(" "),s("strong",[a._v("权限列表")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("show privileges;\n")])])]),s("ul",[s("li",[s("code",[a._v("CREATE和DROP权限")]),a._v("，可以创建新的数据库和表，或删除（移掉）已有的数据库和表。如果将MySQL数据库中的DROP权限授予某用户，用户就可以删除MySQL访问权限保存的数据库。")]),a._v(" "),s("li",[s("code",[a._v("SELECT、INSERT、UPDATE和DELETE权限")]),a._v("允许在一个数据库现有的表上实施操作。")]),a._v(" "),s("li",[s("code",[a._v("SELECT权限")]),a._v("只有在它们真正从一个表中检索行时才被用到。")]),a._v(" "),s("li",[s("code",[a._v("INDEX权限")]),a._v("允许创建或删除索引，INDEX适用于已有的表。如果具有某个表的CREATE权限，就可以在CREATE TABLE语句中包括索引定义。")]),a._v(" "),s("li",[s("code",[a._v("ALTER权限")]),a._v("可以使用ALTER TABLE来更改表的结构和重新命名表。")]),a._v(" "),s("li",[s("code",[a._v("CREATE ROUTINE权限")]),a._v("用来创建保存的程序（函数和程序），"),s("code",[a._v("ALTER ROUTINE权限")]),a._v("用来更改和删除保存的程序，"),s("code",[a._v("EXECUTE权限")]),a._v("用来执行保存的程序。")]),a._v(" "),s("li",[s("code",[a._v("GRANT权限")]),a._v("允许授权给其他用户，可用于数据库、表和保存的程序。")]),a._v(" "),s("li",[s("code",[a._v("FILE权限")]),a._v("使用户可以使用LOAD DATA INFILE和SELECT ... INTO OUTFILE语句读或写服务器上的文件，任何被授予FILE权限的用户都能读或写MySQL服务器上的任何文件（说明用户可以读任何数据库目录下的文件，因为服务器可以访问这些文件）。")])]),a._v(" "),s("h5",{attrs:{id:"_2-2-授予权限的原则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-授予权限的原则"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.2")]),a._v(" "),s("strong",[a._v("授予权限的原则")])]),a._v(" "),s("p",[a._v("权限控制主要是出于安全因素，因此需要遵循以下几个"),s("code",[a._v("经验原则")]),a._v("：")]),a._v(" "),s("p",[a._v("1、只授予能"),s("code",[a._v("满足需要的最小权限")]),a._v("，防止用户干坏事。比如用户只是需要查询，那就只给select权限就可以了，不要给用户赋予update、insert或者delete权限。")]),a._v(" "),s("p",[a._v("2、创建用户的时候"),s("code",[a._v("限制用户的登录主机")]),a._v("，一般是限制成指定IP或者内网IP段。")]),a._v(" "),s("p",[a._v("3、为每个用户"),s("code",[a._v("设置满足密码复杂度的密码")]),a._v("。")]),a._v(" "),s("p",[a._v("4、"),s("code",[a._v("定期清理不需要的用户")]),a._v("，回收权限或者删除用户。")]),a._v(" "),s("h5",{attrs:{id:"_2-3-授予权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-授予权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.3")]),a._v(" "),s("strong",[a._v("授予权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GRANT 权限1,权限2,…权限n ON 数据库名称.表名称 TO 用户名@用户地址 [IDENTIFIED BY ‘密码口令’];\n")])])]),s("ul",[s("li",[a._v("该权限如果发现没有该用户，则会直接新建一个用户。")]),a._v(" "),s("li",[a._v("给li4用户用本地命令行方式，授予atguigudb这个库下的所有表的插删改查的权限。")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GRANT SELECT,INSERT,DELETE,UPDATE ON atguigudb.* TO li4@localhost;\n")])])]),s("ul",[s("li",[a._v("授予通过网络方式登录的joe用户 ，对所有库所有表的全部权限，密码设为123。注意这里唯独不包括grant的权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GRANT ALL PRIVILEGES ON *.* TO joe@'%' IDENTIFIED BY '123';\n")])])]),s("h5",{attrs:{id:"_2-4-查看权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-查看权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.4")]),a._v(" "),s("strong",[a._v("查看权限")])]),a._v(" "),s("ul",[s("li",[a._v("查看当前用户权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SHOW GRANTS; \n# 或 \nSHOW GRANTS FOR CURRENT_USER; \n# 或 \nSHOW GRANTS FOR CURRENT_USER();\n")])])]),s("ul",[s("li",[a._v("查看某用户的全局权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SHOW GRANTS FOR 'user'@'主机地址';\n")])])]),s("h5",{attrs:{id:"_2-5-收回权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-收回权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("2.5")]),a._v(" "),s("strong",[a._v("收回权限")])]),a._v(" "),s("p",[s("strong",[a._v("注意：在将用户账户从user表删除之前，应该收回相应用户的所有权限。")])]),a._v(" "),s("ul",[s("li",[a._v("收回权限命令")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("REVOKE 权限1,权限2,…权限n ON 数据库名称.表名称 FROM 用户名@用户地址;\n")])])]),s("ul",[s("li",[a._v("举例")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#收回全库全表的所有权限 \nREVOKE ALL PRIVILEGES ON *.* FROM joe@'%'; \n#收回mysql库下的所有表的插删改查权限 \nREVOKE SELECT,INSERT,UPDATE,DELETE ON mysql.* FROM joe@localhost;\n")])])]),s("ul",[s("li",[a._v("注意："),s("code",[a._v("须用户重新登录后才能生效")])])]),a._v(" "),s("h4",{attrs:{id:"_3-角色管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-角色管理"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.")]),a._v(" "),s("strong",[a._v("角色管理")])]),a._v(" "),s("h5",{attrs:{id:"_3-1-创建角色"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-创建角色"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.1")]),a._v(" "),s("strong",[a._v("创建角色")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("CREATE ROLE 'role_name'[@'host_name'] [,'role_name'[@'host_name']]...\n")])])]),s("p",[a._v("角色名称的命名规则和用户名类似。如果"),s("code",[a._v("host_name省略，默认为%")]),a._v("，"),s("code",[a._v("role_name不可省略")]),a._v("，不可为空。")]),a._v(" "),s("h5",{attrs:{id:"_3-2-给角色赋予权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-给角色赋予权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.2")]),a._v(" "),s("strong",[a._v("给角色赋予权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GRANT privileges ON table_name TO 'role_name'[@'host_name'];\n")])])]),s("p",[a._v("上述语句中privileges代表权限的名称，多个权限以逗号隔开。可使用SHOW语句查询权限名称")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SHOW PRIVILEGES\\G\n")])])]),s("h5",{attrs:{id:"_3-3-查看角色的权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-查看角色的权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.3")]),a._v(" "),s("strong",[a._v("查看角色的权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SHOW GRANTS FOR 'role_name';\n")])])]),s("p",[a._v("只要你创建了一个角色，系统就会自动给你一个“"),s("code",[a._v("USAGE")]),a._v("”权限，意思是"),s("code",[a._v("连接登录数据库的权限")]),a._v("。")]),a._v(" "),s("h5",{attrs:{id:"_3-4-回收角色的权限"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-回收角色的权限"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.4")]),a._v(" "),s("strong",[a._v("回收角色的权限")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("REVOKE privileges ON tablename FROM 'rolename';\n")])])]),s("h5",{attrs:{id:"_3-5-删除角色"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-删除角色"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.5")]),a._v(" "),s("strong",[a._v("删除角色")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("DROP ROLE role [,role2]...\n")])])]),s("p",[a._v("注意，"),s("code",[a._v("如果你删除了角色，那么用户也就失去了通过这个角色所获得的所有权限")]),a._v("。")]),a._v(" "),s("h5",{attrs:{id:"_3-6-给用户赋予角色"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-给用户赋予角色"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.6")]),a._v(" "),s("strong",[a._v("给用户赋予角色")])]),a._v(" "),s("p",[a._v("角色创建并授权后，要赋给用户并处于"),s("code",[a._v("激活状态")]),a._v("才能发挥作用。")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GRANT role [,role2,...] TO user [,user2,...];\n")])])]),s("p",[a._v("查询当前已激活的角色")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SELECT CURRENT_ROLE();\n")])])]),s("h5",{attrs:{id:"_3-7-激活角色"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-激活角色"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.7")]),a._v(" "),s("strong",[a._v("激活角色")])]),a._v(" "),s("p",[s("strong",[a._v("方式1：使用set default role 命令激活角色")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET DEFAULT ROLE ALL TO 'kangshifu'@'localhost';\n")])])]),s("p",[s("strong",[a._v("方式2：将activate_all_roles_on_login设置为ON")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET GLOBAL activate_all_roles_on_login=ON;\n")])])]),s("p",[a._v("这条 SQL 语句的意思是，对"),s("code",[a._v("所有角色永久激活")]),a._v("。")]),a._v(" "),s("h5",{attrs:{id:"_3-8-撤销用户的角色"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-撤销用户的角色"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.8")]),a._v(" "),s("strong",[a._v("撤销用户的角色")])]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("REVOKE role FROM user;\n")])])]),s("h5",{attrs:{id:"_3-9-设置强制角色-mandatory-role"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-设置强制角色-mandatory-role"}},[a._v("#")]),a._v(" "),s("strong",[a._v("3.9")]),a._v(" "),s("strong",[a._v("设置强制角色(mandatory role)")])]),a._v(" "),s("p",[a._v("方式1：服务启动前设置")]),a._v(" "),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqld")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v(" \n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("mandatory_roles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("'"),s("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("role1,role2@localhost,r3@%.atguigu.com")]),a._v("'")]),a._v("\n")])])]),s("p",[a._v("方式2：运行时设置")]),a._v(" "),s("div",{staticClass:"language-mysql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET PERSIST mandatory_roles = 'role1,role2@localhost,r3@%.example.com'; #系统重启后仍然有效\nSET GLOBAL mandatory_roles = 'role1,role2@localhost,r3@%.example.com'; #系统重启后失效\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);